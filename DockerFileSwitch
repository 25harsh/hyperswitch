FROM debian:bookworm-slim
ARG EXTRA_FEATURES=""
RUN apt-get update \
    && apt-get install -y libpq-dev libssl-dev pkg-config

EXPOSE 8080

RUN mkdir -p /app

COPY ./config/docker_compose.toml /app/docker_compose.toml
COPY ./target/debug/router /app/router

WORKDIR /app

COPY . .

CMD ["./router","-f","./docker_compose.toml"]